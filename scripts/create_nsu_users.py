#!/usr/bin/env python3
"""
–°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ù–ì–£ –ø–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞–º –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º
"""
import psycopg2
from faker import Faker

fake = Faker('ru_RU')

DB_CONFIG = {
    "host": "localhost",
    "port": 5432,
    "database": "library_search",
    "user": "library_user",
    "password": "library_password"
}

# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ù–ì–£: —Ñ–∞–∫—É–ª—å—Ç–µ—Ç/–∏–Ω—Å—Ç–∏—Ç—É—Ç -> –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
NSU_STRUCTURE = {
    "–ì—É–º–∞–Ω–∏—Ç–∞—Ä–Ω—ã–π –∏–Ω—Å—Ç–∏—Ç—É—Ç": [
        "–í–æ—Å—Ç–æ–∫–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –∞—Ñ—Ä–∏–∫–∞–Ω–∏—Å—Ç–∏–∫–∞",
        "–ò—Å—Ç–æ—Ä–∏—è",
        "–§–∏–ª–æ–ª–æ–≥–∏—è",
        "–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞",
        "–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏",
        "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞",
        "–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–∞—è –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞"
    ],
    "–ò–Ω—Å—Ç–∏—Ç—É—Ç –º–µ–¥–∏—Ü–∏–Ω—ã –∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π": [
        "–õ–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ",
        "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è",
        "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∏–±–µ—Ä–Ω–µ—Ç–∏–∫–∞"
    ],
    "–ò–Ω—Å—Ç–∏—Ç—É—Ç —Ñ–∏–ª–æ—Å–æ—Ñ–∏–∏ –∏ –ø—Ä–∞–≤–∞": [
        "–§–∏–ª–æ—Å–æ—Ñ–∏—è",
        "–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è"
    ],
    "–§–∏–∑–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç": [],
    "–ú–µ—Ö–∞–Ω–∏–∫–æ-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç": [],
    "–§–∞–∫—É–ª—å—Ç–µ—Ç –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–∞—É–∫": [
        "–ë–∏–æ–ª–æ–≥–∏—è",
        "–•–∏–º–∏—è"
    ],
    "–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π": [],
    "–≠–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç": [
        "–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç",
        "–≠–∫–æ–Ω–æ–º–∏–∫–∞",
        "–°–æ—Ü–∏–æ–ª–æ–≥–∏—è",
        "–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è",
        "–ë–∏–∑–Ω–µ—Å-–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞"
    ],
    "–ì–µ–æ–ª–æ–≥–æ-–≥–µ–æ—Ñ–∏–∑–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç": [
        "–ì–µ–æ—Ñ–∏–∑–∏–∫–∞",
        "–ì–µ–æ—Ö–∏–º–∏—è",
        "–ì–µ–æ–ª–æ–≥–∏—è",
        "–ù–µ—Ñ—Ç—å –∏ –≥–∞–∑"
    ]
}

# –ò–Ω—Ç–µ—Ä–µ—Å—ã –ø–æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º
INTERESTS = {
    "–í–æ—Å—Ç–æ–∫–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –∞—Ñ—Ä–∏–∫–∞–Ω–∏—Å—Ç–∏–∫–∞": ["–≤–æ—Å—Ç–æ—á–Ω—ã–µ —è–∑—ã–∫–∏", "–∫—É–ª—å—Ç—É—Ä–∞ –ê–∑–∏–∏", "–∞—Ñ—Ä–∏–∫–∞–Ω–∏—Å—Ç–∏–∫–∞", "–º–µ–∂–¥—É–Ω–∞—Ä–æ–¥–Ω—ã–µ –æ—Ç–Ω–æ—à–µ–Ω–∏—è"],
    "–ò—Å—Ç–æ—Ä–∏—è": ["–∏—Å—Ç–æ—Ä–∏—è –†–æ—Å—Å–∏–∏", "–∞—Ä—Ö–µ–æ–ª–æ–≥–∏—è", "–≤—Å–µ–º–∏—Ä–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è", "–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤–µ–¥–µ–Ω–∏–µ"],
    "–§–∏–ª–æ–ª–æ–≥–∏—è": ["—Ä—É—Å—Å–∫–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞", "—Ç–µ–æ—Ä–∏—è —è–∑—ã–∫–∞", "–ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–æ–≤–µ–¥–µ–Ω–∏–µ", "—Ç–µ–∫—Å—Ç–æ–ª–æ–≥–∏—è"],
    "–õ–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞": ["—è–∑—ã–∫–æ–∑–Ω–∞–Ω–∏–µ", "—Å–µ–º–∞–Ω—Ç–∏–∫–∞", "—Å–∏–Ω—Ç–∞–∫—Å–∏—Å", "—Ñ–æ–Ω–µ—Ç–∏–∫–∞"],
    "–ò–Ω–æ—Å—Ç—Ä–∞–Ω–Ω—ã–µ —è–∑—ã–∫–∏": ["–∞–Ω–≥–ª–∏–π—Å–∫–∏–π —è–∑—ã–∫", "–ø–µ—Ä–µ–≤–æ–¥", "–º–µ–∂–∫—É–ª—å—Ç—É—Ä–Ω–∞—è –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è"],
    "–ñ—É—Ä–Ω–∞–ª–∏—Å—Ç–∏–∫–∞": ["–º–µ–¥–∏–∞", "–°–ú–ò", "–ø—É–±–ª–∏—Ü–∏—Å—Ç–∏–∫–∞", "–Ω–æ–≤—ã–µ –º–µ–¥–∏–∞"],
    "–§—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–∞—è –∏ –ø—Ä–∏–∫–ª–∞–¥–Ω–∞—è –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞": ["–∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–∞—è –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞", "–∫–æ—Ä–ø—É—Å–Ω–∞—è –ª–∏–Ω–≥–≤–∏—Å—Ç–∏–∫–∞", "NLP"],
    "–õ–µ—á–µ–±–Ω–æ–µ –¥–µ–ª–æ": ["—Ç–µ—Ä–∞–ø–∏—è", "—Ö–∏—Ä—É—Ä–≥–∏—è", "–∞–Ω–∞—Ç–æ–º–∏—è", "—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—è"],
    "–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è": ["–∫–ª–∏–Ω–∏—á–µ—Å–∫–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è", "–∫–æ–≥–Ω–∏—Ç–∏–≤–Ω–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è", "–Ω–µ–π—Ä–æ–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è"],
    "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∫–∏–±–µ—Ä–Ω–µ—Ç–∏–∫–∞": ["–±–∏–æ–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞", "–º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Å–∏—Å—Ç–µ–º—ã", "–∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö"],
    "–§–∏–ª–æ—Å–æ—Ñ–∏—è": ["–æ–Ω—Ç–æ–ª–æ–≥–∏—è", "—ç–ø–∏—Å—Ç–µ–º–æ–ª–æ–≥–∏—è", "—ç—Ç–∏–∫–∞", "–ª–æ–≥–∏–∫–∞"],
    "–Æ—Ä–∏—Å–ø—Ä—É–¥–µ–Ω—Ü–∏—è": ["–≥—Ä–∞–∂–¥–∞–Ω—Å–∫–æ–µ –ø—Ä–∞–≤–æ", "—É–≥–æ–ª–æ–≤–Ω–æ–µ –ø—Ä–∞–≤–æ", "–∫–æ–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–Ω–æ–µ –ø—Ä–∞–≤–æ"],
    "–§–∏–∑–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç": ["–∫–≤–∞–Ω—Ç–æ–≤–∞—è —Ñ–∏–∑–∏–∫–∞", "–æ–ø—Ç–∏–∫–∞", "—Ñ–∏–∑–∏–∫–∞ —Ç–≤–µ—Ä–¥–æ–≥–æ —Ç–µ–ª–∞", "–∞—Å—Ç—Ä–æ—Ñ–∏–∑–∏–∫–∞"],
    "–ú–µ—Ö–∞–Ω–∏–∫–æ-–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∞–∫—É–ª—å—Ç–µ—Ç": ["–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑", "–∞–ª–≥–µ–±—Ä–∞", "–¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è", "–º–µ—Ö–∞–Ω–∏–∫–∞"],
    "–ë–∏–æ–ª–æ–≥–∏—è": ["–≥–µ–Ω–µ—Ç–∏–∫–∞", "–º–æ–ª–µ–∫—É–ª—è—Ä–Ω–∞—è –±–∏–æ–ª–æ–≥–∏—è", "—ç–∫–æ–ª–æ–≥–∏—è", "–º–∏–∫—Ä–æ–±–∏–æ–ª–æ–≥–∏—è"],
    "–•–∏–º–∏—è": ["–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è —Ö–∏–º–∏—è", "–Ω–µ–æ—Ä–≥–∞–Ω–∏—á–µ—Å–∫–∞—è —Ö–∏–º–∏—è", "–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è —Ö–∏–º–∏—è", "–±–∏–æ—Ö–∏–º–∏—è"],
    "–§–∞–∫—É–ª—å—Ç–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π": ["–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ", "–∞–ª–≥–æ—Ä–∏—Ç–º—ã", "–º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ", "–±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"],
    "–ú–µ–Ω–µ–¥–∂–º–µ–Ω—Ç": ["—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ", "—Å—Ç—Ä–∞—Ç–µ–≥–∏—á–µ—Å–∫–∏–π –º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç", "HR", "–º–∞—Ä–∫–µ—Ç–∏–Ω–≥"],
    "–≠–∫–æ–Ω–æ–º–∏–∫–∞": ["–º–∏–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏–∫–∞", "–º–∞–∫—Ä–æ—ç–∫–æ–Ω–æ–º–∏–∫–∞", "—ç–∫–æ–Ω–æ–º–µ—Ç—Ä–∏–∫–∞", "—Ñ–∏–Ω–∞–Ω—Å—ã"],
    "–°–æ—Ü–∏–æ–ª–æ–≥–∏—è": ["—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è", "–¥–µ–º–æ–≥—Ä–∞—Ñ–∏—è", "—Å–æ—Ü–∏–∞–ª—å–Ω–∞—è –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è"],
    "–ë–∏–∑–Ω–µ—Å-–∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–∞": ["–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã", "–±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∞", "ERP"],
    "–ì–µ–æ—Ñ–∏–∑–∏–∫–∞": ["—Å–µ–π—Å–º–æ–ª–æ–≥–∏—è", "–≥–µ–æ–º–∞–≥–Ω–µ—Ç–∏–∑–º", "–≥—Ä–∞–≤–∏–º–µ—Ç—Ä–∏—è"],
    "–ì–µ–æ—Ö–∏–º–∏—è": ["–∏–∑–æ—Ç–æ–ø–Ω–∞—è –≥–µ–æ—Ö–∏–º–∏—è", "–º–∏–Ω–µ—Ä–∞–ª–æ–≥–∏—è", "–ø–µ—Ç—Ä–æ–ª–æ–≥–∏—è"],
    "–ì–µ–æ–ª–æ–≥–∏—è": ["—Å—Ç—Ä–∞—Ç–∏–≥—Ä–∞—Ñ–∏—è", "—Ç–µ–∫—Ç–æ–Ω–∏–∫–∞", "–ø–∞–ª–µ–æ–Ω—Ç–æ–ª–æ–≥–∏—è"],
    "–ù–µ—Ñ—Ç—å –∏ –≥–∞–∑": ["–Ω–µ—Ñ—Ç–µ–≥–∞–∑–æ–≤–∞—è –≥–µ–æ–ª–æ–≥–∏—è", "—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –º–µ—Å—Ç–æ—Ä–æ–∂–¥–µ–Ω–∏–π", "–≥–µ–æ—Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã"]
}

# –†–æ–ª–∏
ROLES = [
    {"role": "student", "course": 1, "suffix": "—Å—Ç—É–¥–µ–Ω—Ç_1–∫—É—Ä—Å"},
    {"role": "student", "course": 4, "suffix": "—Å—Ç—É–¥–µ–Ω—Ç_4–∫—É—Ä—Å"},
    {"role": "master", "course": 1, "suffix": "–º–∞–≥–∏—Å—Ç—Ä–∞–Ω—Ç"},
    {"role": "phd", "course": None, "suffix": "–∞—Å–ø–∏—Ä–∞–Ω—Ç"},
    {"role": "professor", "course": None, "suffix": "–ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å"}
]


def generate_username(direction, role_suffix, index):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è username"""
    # –°–æ–∫—Ä–∞—â–∞–µ–º –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
    short = direction.lower()[:10].replace(' ', '_')
    short = ''.join(c for c in short if c.isalnum() or c == '_')
    return f"{short}_{role_suffix}_{index}"


def generate_email(username):
    """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è email"""
    return f"{username}@nsu.ru"


def create_users():
    """–°–æ–∑–¥–∞—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
    users = []
    user_index = 1
    
    for faculty, directions in NSU_STRUCTURE.items():
        # –ï—Å–ª–∏ –Ω–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π - –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ñ–∞–∫—É–ª—å—Ç–µ—Ç –∫–∞–∫ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
        if not directions:
            directions = [faculty]
        
        for direction in directions:
            # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ç–µ—Ä–µ—Å—ã –¥–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
            interests = INTERESTS.get(direction, INTERESTS.get(faculty, ["–Ω–∞—É–∫–∞", "–∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è"]))
            
            for role_info in ROLES:
                username = generate_username(direction, role_info["suffix"], user_index)
                email = generate_email(username)
                
                user = {
                    "username": username,
                    "email": email,
                    "role": role_info["role"],
                    "specialization": direction,
                    "faculty": faculty,
                    "course": role_info["course"],
                    "interests": interests[:3]  # –ë–µ—Ä—ë–º 3 –∏–Ω—Ç–µ—Ä–µ—Å–∞
                }
                
                users.append(user)
                user_index += 1
    
    return users


def save_to_database(users):
    """–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –ë–î"""
    conn = psycopg2.connect(**DB_CONFIG)
    cursor = conn.cursor()
    
    try:
        # –£–¥–∞–ª—è–µ–º —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
        print("üóëÔ∏è  –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...")
        cursor.execute("DELETE FROM clicks")
        cursor.execute("DELETE FROM impressions")
        cursor.execute("DELETE FROM search_queries")
        cursor.execute("DELETE FROM users")
        conn.commit()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º/–¥–æ–±–∞–≤–ª—è–µ–º –∫–æ–ª–æ–Ω–∫—É faculty
        cursor.execute("""
            SELECT column_name FROM information_schema.columns 
            WHERE table_name = 'users' AND column_name = 'faculty'
        """)
        if not cursor.fetchone():
            print("üìã –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–∫–∏ faculty...")
            cursor.execute("ALTER TABLE users ADD COLUMN faculty VARCHAR(100)")
            conn.commit()
        
        # –í—Å—Ç–∞–≤–ª—è–µ–º –Ω–æ–≤—ã—Ö
        print(f"üë• –°–æ–∑–¥–∞–Ω–∏–µ {len(users)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π...")
        
        for user in users:
            cursor.execute("""
                INSERT INTO users (username, email, role, specialization, faculty, course, interests)
                VALUES (%s, %s, %s, %s, %s, %s, %s)
            """, (
                user["username"],
                user["email"],
                user["role"],
                user["specialization"],
                user["faculty"],
                user["course"],
                user["interests"]
            ))
        
        conn.commit()
        print(f"‚úÖ –°–æ–∑–¥–∞–Ω–æ {len(users)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        cursor.execute("SELECT role, COUNT(*) FROM users GROUP BY role ORDER BY role")
        print("\nüìä –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ä–æ–ª—è–º:")
        for row in cursor.fetchall():
            print(f"   {row[0]}: {row[1]}")
        
        cursor.execute("SELECT faculty, COUNT(*) FROM users GROUP BY faculty ORDER BY faculty")
        print("\nüèõÔ∏è  –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞–º:")
        for row in cursor.fetchall():
            print(f"   {row[0]}: {row[1]}")
        
    finally:
        cursor.close()
        conn.close()


def main():
    print("=" * 60)
    print("üë• –°–û–ó–î–ê–ù–ò–ï –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–ï–ô –ù–ì–£")
    print("=" * 60)
    
    users = create_users()
    
    print(f"\nüìã –ë—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {len(users)}")
    print(f"   –§–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤/–∏–Ω—Å—Ç–∏—Ç—É—Ç–æ–≤: {len(NSU_STRUCTURE)}")
    
    # –ü–æ–¥—Å—á—ë—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
    total_directions = sum(len(d) if d else 1 for d in NSU_STRUCTURE.values())
    print(f"   –ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π: {total_directions}")
    print(f"   –†–æ–ª–µ–π –Ω–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: {len(ROLES)}")
    
    save_to_database(users)
    
    print("\n" + "=" * 60)
    print("‚úÖ –ì–û–¢–û–í–û!")
    print("=" * 60)
    
    print("\nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞:")
    print("   curl http://localhost:8000/api/users/ | python -m json.tool")


if __name__ == "__main__":
    main()
